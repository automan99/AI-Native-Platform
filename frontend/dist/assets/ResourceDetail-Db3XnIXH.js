import{_ as $,g as H,o as a,c as r,b as e,t as n,n as m,e as i,h as d,a as y,r as u,i as D,f as N}from"./index-B70JlMxX.js";import{r as g}from"./resources-kY_Hbd4z.js";import{n as p}from"./notification-D4aQ7HzA.js";const R={class:"resource-detail-page"},T={key:0,class:"loading-state"},S={key:1,class:"detail-container"},Z={class:"detail-header"},z={class:"header-row header-row-main"},I={class:"resource-name"},F={class:"header-right"},O={class:"header-badges"},j={class:"version"},A={class:"header-meta-inline"},E={key:0,class:"meta-item",title:"仓库添加者"},J={key:2,class:"meta-divider"},U={class:"meta-item"},q={class:"meta-item stat"},G={class:"meta-item stat"},K={key:0,class:"header-description"},P={class:"command-area"},Q={class:"command-text"},W=["title"],X={key:0,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},Y={key:1,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},ee=["disabled"],te={key:0,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},oe={key:1,class:"spinning",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},se={key:0,class:"content-section"},ae={class:"section-header"},re={class:"view-mode-toggle"},ne=["innerHTML"],le={key:1,class:"markdown-source"},ie={key:1,class:"content-section"},de={class:"metadata-content"},ce={key:2,class:"empty-state"},ve={__name:"ResourceDetail",setup(ue){const C=D();N();const o=u(null),h=u(!0),c=u(!1),f=u(!1),v=u("preview");H(()=>{x()});async function x(){h.value=!0;try{const s=await g.getDetail(C.params.id);s.success?o.value=s.data:p.error(s.message||"加载失败")}catch(s){console.error("Failed to load resource:",s),p.error("加载失败")}finally{h.value=!1}}async function M(){c.value=!0;try{(await g.recordInstall(o.value.id)).success&&(o.value.install_count++,p.success("安装记录成功！"),w())}catch(s){console.error("Failed to record install:",s)}finally{c.value=!1}}function w(){const s=o.value.install_command;navigator.clipboard.writeText(s).then(()=>{f.value=!0,p.success("命令已复制到剪贴板"),setTimeout(()=>{f.value=!1},2e3)}).catch(()=>{p.warning("复制失败，请手动复制")})}function B(){var s;(s=o.value)!=null&&s.repository_url&&window.open(o.value.repository_url,"_blank")}function k(s){return s?s.toLocaleString():"0"}function L(s){if(!s)return"-";const t=new Date(s),V=new Date-t,l=Math.floor(V/(1e3*60*60*24));return l===0?"今天":l===1?"昨天":l<7?`${l}天前`:l<30?`${Math.floor(l/7)}周前`:l<365?`${Math.floor(l/30)}月前`:`${Math.floor(l/365)}年前`}function b(s){return s?s.replace(/^### (.*$)/gim,"<h3>$1</h3>").replace(/^## (.*$)/gim,"<h2>$1</h2>").replace(/^# (.*$)/gim,"<h1>$1</h1>").replace(/\*\*(.*)\*\*/gim,"<strong>$1</strong>").replace(/\*(.*)\*/gim,"<em>$1</em>").replace(/```([\s\S]*?)```/gim,"<pre><code>$1</code></pre>").replace(/`([^`]+)`/gim,"<code>$1</code>").replace(/\n/gim,"<br>"):""}return(s,t)=>(a(),r("div",R,[h.value?(a(),r("div",T,[...t[2]||(t[2]=[e("svg",{class:"spinner",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[e("circle",{cx:"12",cy:"12",r:"10","stroke-dasharray":"60","stroke-dashoffset":"20"})],-1)])])):o.value?(a(),r("div",S,[e("div",Z,[e("div",z,[e("h1",I,n(o.value.name),1),e("div",F,[e("div",O,[e("div",{class:m(["type-badge",`type-${o.value.type}`])},[t[3]||(t[3]=e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[e("path",{d:"M12 2L15 8L21 9L17 14L18 20L12 17L6 20L7 14L3 9L9 8L12 2Z"})],-1)),i(" "+n(o.value.type.toUpperCase()),1)],2),e("span",j,n(o.value.version||"v1.0.0"),1)]),e("div",A,[o.value.repository_owner?(a(),r("span",E,[t[4]||(t[4]=e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[e("path",{d:"M20 21v-2c0-1.1-.9-2-2-2H6c-1.1 0-2 .9-2 2v2"}),e("circle",{cx:"12",cy:"7",r:"4"})],-1)),i(" "+n(o.value.repository_owner),1)])):d("",!0),o.value.repository_url?(a(),r("span",{key:1,class:"meta-item link-item",onClick:B,title:"打开仓库"},[...t[5]||(t[5]=[y('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" data-v-1fdf1aa8><path d="M3 7v10c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V9c0-1.1-.9-2-2-2h-6l-2-2H5c-1.1 0-2 .9-2 2z" data-v-1fdf1aa8></path></svg><svg class="external-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" data-v-1fdf1aa8><path d="M18 13v6a2 2 0 0 1-2 2H5c-1.1 0-2-.9-2-2V8c0-1.1.9-2 2-2h6" data-v-1fdf1aa8></path><polyline points="15 3 21 3 21 9" data-v-1fdf1aa8></polyline><line x1="10" y1="14" x2="21" y2="3" data-v-1fdf1aa8></line></svg>',2)])])):d("",!0),(o.value.repository_owner||o.value.repository_url)&&(o.value.updated_at||o.value.view_count||o.value.install_count)?(a(),r("span",J,"•")):d("",!0),e("span",U,[t[6]||(t[6]=e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[e("path",{d:"M12 8v4l3 3m-3-3v8"}),e("path",{d:"M6 12h6"}),e("circle",{cx:"12",cy:"12",r:"10"})],-1)),i(" "+n(L(o.value.updated_at)),1)]),t[9]||(t[9]=e("span",{class:"meta-divider"},"•",-1)),e("span",q,[t[7]||(t[7]=e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"}),e("circle",{cx:"12",cy:"12",r:"3"})],-1)),i(" "+n(k(o.value.view_count)),1)]),t[10]||(t[10]=e("span",{class:"meta-divider"},"•",-1)),e("span",G,[t[8]||(t[8]=e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[e("path",{d:"M21 15v4c0 .5304-.2107 1.0391-.5858 1.4142-.3905.3752-.8787.5858-1.4142.5858H5c-.5304 0-1.0391-.2107-1.4142-.5858C3.2107 17.0391 3 16.5304 3 16v-4"}),e("path",{d:"M7 10l5 5 5-5"}),e("path",{d:"M12 3v12"})],-1)),i(" "+n(k(o.value.install_count)),1)])])])]),o.value.description?(a(),r("div",K,n(o.value.description),1)):d("",!0),e("div",P,[t[15]||(t[15]=e("span",{class:"command-prompt"},"$",-1)),e("code",Q,n(o.value.install_command),1),e("button",{class:"copy-icon-btn",onClick:w,title:f.value?"已复制!":"复制命令"},[f.value?(a(),r("svg",Y,[...t[12]||(t[12]=[e("path",{d:"M20 6L9 17l-5-5"},null,-1)])])):(a(),r("svg",X,[...t[11]||(t[11]=[e("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2"},null,-1),e("path",{d:"M5 15H4c-.5304 0-1.0391-.2107-1.4142-.5858C2.2107 14.2107 2 13.5304 2 13V4c0-.5304.2107-1.0391.5858-1.4142C2.9609 2.2107 3.4696 2 4 2h9c.5304 0 1.0391.2107 1.4142.5858C14.7893 2.7893 15 3.4696 15 4v1"},null,-1)])]))],8,W),e("button",{class:"install-inline-btn",onClick:M,disabled:c.value},[c.value?(a(),r("svg",oe,[...t[14]||(t[14]=[e("path",{d:"M12 2v4M12 18v4M4.93 4.93l2.83 2.83M16.24 16.24l2.83 2.83M2 12h4M18 12h4"},null,-1)])])):(a(),r("svg",te,[...t[13]||(t[13]=[e("path",{d:"M21 15V19C21 19.5304 20.7893 20.0391 20.4142 20.4142C20.0391 20.7893 19.5304 21 19 21H5C4.46957 21 3.96086 20.7893 3.58579 20.4142C3.21071 20.0391 3 19.5304 3 19V15"},null,-1),e("path",{d:"M7 10L12 15L17 10M12 15V3"},null,-1)])])),i(" "+n(c.value?"安装中...":"安装"),1)],8,ee)])]),o.value.readme_content?(a(),r("div",se,[e("div",ae,[t[18]||(t[18]=e("div",{class:"section-header-left"},[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[e("path",{d:"M14 2H6C5.46957 2 4.96086 2.21071 4.58579 2.58579C4.21071 2.96086 4 3.46957 4 4V20C4 20.5304 4.21071 21.0391 4.58579 21.4142C4.96086 21.7893 5.46957 22 6 22H18C18.5304 22 19.0391 21.7893 19.4142 21.4142C19.7893 21.0391 20 20.5304 20 20V8L14 2Z"}),e("path",{d:"M14 2V8H20"})]),e("span",null,"内容")],-1)),e("div",re,[e("button",{class:m(["mode-btn",{active:v.value==="preview"}]),onClick:t[0]||(t[0]=_=>v.value="preview"),title:"预览模式"},[...t[16]||(t[16]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[e("path",{d:"M1 12s4-8 11-8 11 11 0 0 0 11 8 8 0 0 0-11-8 0 0 0-11 8 8 0 0 0 8 8 0 0 0 11-8 8 0 0 0-11 8z"}),e("circle",{cx:"12",cy:"12",r:"3"})],-1),e("span",null,"预览",-1)])],2),e("button",{class:m(["mode-btn",{active:v.value==="markdown"}]),onClick:t[1]||(t[1]=_=>v.value="markdown"),title:"Markdown 源码"},[...t[17]||(t[17]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[e("path",{d:"M14 2H6C5.46957 2 4.96086 2.21071 4.58579 2.58579C4.21071 2.96086 4 3.46957 4 4V20C4 20.5304 4.21071 21.0391 4.58579 21.4142C4.96086 21.7893 5.46957 22 6 22H18C18.5304 22 19.0391 21.7893 19.4142 21.4142C19.7893 21.0391 20 20.5304 20 20V8L14 2Z"}),e("path",{d:"M14 2V8H20"}),e("path",{d:"M9 11h6M9 15h6"})],-1),e("span",null,"Markdown",-1)])],2)])]),v.value==="preview"?(a(),r("div",{key:0,class:"readme-content",innerHTML:b(o.value.readme_content)},null,8,ne)):(a(),r("pre",le,n(o.value.readme_content),1))])):d("",!0),o.value.extra_data&&Object.keys(o.value.extra_data).length>0?(a(),r("div",ie,[t[19]||(t[19]=y('<div class="section-header" data-v-1fdf1aa8><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" data-v-1fdf1aa8><rect x="3" y="3" width="7" height="7" data-v-1fdf1aa8></rect><rect x="14" y="3" width="7" height="7" data-v-1fdf1aa8></rect><rect x="14" y="14" width="7" height="7" data-v-1fdf1aa8></rect><rect x="3" y="14" width="7" height="7" data-v-1fdf1aa8></rect></svg><span data-v-1fdf1aa8>元数据</span></div>',1)),e("pre",de,n(JSON.stringify(o.value.extra_data,null,2)),1)])):d("",!0)])):(a(),r("div",ce,[...t[20]||(t[20]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[e("circle",{cx:"12",cy:"12",r:"10"}),e("path",{d:"M12 8V12L15 15"})],-1),e("p",null,"资源不存在",-1)])]))]))}},me=$(ve,[["__scopeId","data-v-1fdf1aa8"]]);export{me as default};
