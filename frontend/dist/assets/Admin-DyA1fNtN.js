import{j as I,_ as le,g as ie,o as n,c as a,b as e,t as d,e as b,F as B,m as R,n as h,h as p,k as j,l as re,B as de,w as u,C as L,v as g,D as T,E as se,T as ue,r as _,x as ce,a as ve,p as oe,q as ne,s as C,y as ae}from"./index-B70JlMxX.js";import{n as m}from"./notification-D4aQ7HzA.js";import{m as D}from"./mcp-CYPAatcg.js";const E={getList(y){return I.get("/repositories",{params:y})},getDetail(y,i=!1){return I.get(`/repositories/${y}`,{params:{include_sensitive:i}})},create(y){return I.post("/repositories",y)},update(y,i){return I.put(`/repositories/${y}`,i)},delete(y){return I.delete(`/repositories/${y}`)},toggle(y){return I.post(`/repositories/${y}/toggle`)},sync(y){return I.post(`/repositories/${y}/sync`)},getStatus(y){return I.get(`/repositories/${y}/status`)}},pe={class:"repository-manage-page"},me={class:"action-bar"},fe={class:"repo-count"},be={class:"repo-list"},_e={class:"repo-card__header"},ge={class:"repo-card__left"},ye={class:"repo-card__info"},he={class:"repo-card__name"},ke={key:0,class:"badge badge--disabled"},we={class:"repo-card__url"},Ce={key:0,class:"repo-card__desc"},Me={key:0,class:"repo-card__meta"},xe={key:0,class:"meta-tag"},$e={key:1,class:"meta-tag"},Se={class:"meta-tag"},Ve={class:"meta-tag"},ze={class:"repo-card__footer"},Ue={class:"repo-stats"},Be={class:"stat"},He={class:"stat"},Ie={class:"repo-actions"},Te=["onClick","title"],Le={viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},Ae={key:0,d:"M12 6v12M8 10l4 4 4-4"},De={key:1,d:"M15 9l-6 6M9 9l6 6"},Ee=["onClick","disabled"],Pe=["onClick"],Ge=["onClick"],Re={key:0,class:"empty-state"},Fe={class:"wizard-modal"},qe={class:"wizard-steps"},Ne={class:"wizard-step__number"},Oe={key:0,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},We={key:1},je={class:"wizard-step__label"},Ke={class:"wizard-content"},Ye={class:"wizard-panel"},Ze={class:"form-field"},Je={class:"form-field"},Qe=["disabled"],Xe={key:0,class:"form-hint"},et={class:"form-field"},tt={class:"form-row"},st={class:"form-field"},lt={class:"form-field"},ot={class:"wizard-panel"},nt={class:"form-field"},at={class:"radio-cards"},it={key:0,class:"form-field"},rt={key:0,class:"form-hint"},dt={key:1,class:"form-field"},ut={key:0,class:"form-hint"},ct={class:"wizard-panel"},vt={class:"form-field"},pt={class:"radio-cards"},mt={key:0,class:"form-field"},ft={key:1},bt={class:"form-field"},_t={key:0,class:"form-hint"},gt={class:"form-field"},yt={class:"wizard-panel"},ht={class:"confirm-section"},kt={class:"confirm-group"},wt={class:"confirm-item"},Ct={class:"confirm-item"},Mt={class:"mono"},xt={key:0,class:"confirm-item"},$t={class:"confirm-item"},St={class:"mono"},Vt={key:1,class:"confirm-item"},zt={class:"mono"},Ut={class:"confirm-group"},Bt={class:"confirm-item"},Ht={key:0,class:"confirm-item"},It={key:1,class:"confirm-item"},Tt={class:"confirm-group"},Lt={class:"confirm-item"},At={key:0,class:"confirm-item"},Dt={key:1,class:"confirm-item"},Et={class:"mono"},Pt={class:"confirm-item"},Gt={class:"form-field"},Rt={class:"checkbox checkbox--large"},Ft={class:"wizard-footer"},qt={key:1},Nt={class:"wizard-footer__right"},Ot=["disabled"],Wt=["disabled"],jt={key:0,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Kt={key:1},Yt={key:2},Zt={__name:"RepositoryManage",setup(y){const i=_([]),S=_(!1),r=_(!1),k=_(!1),w=_(!1),M=_(null),c=_(0),v=[{label:"基础信息"},{label:"认证配置"},{label:"同步配置"},{label:"确认配置"}],s=_({name:"",description:"",url:"",branch:"main",path:"",auth_type:"public",auth_token:"",ssh_key:"",sync_mode:"manual",sync_interval:60,sync_enabled:!0,enabled:!0,webhook_secret:"",webhook_url:""}),x=_(!1),$=_(!1),V=_(!1),z=ce(()=>{switch(c.value){case 0:return s.value.name&&s.value.url;case 1:return!(s.value.auth_type==="token"&&!s.value.auth_token&&!x.value||s.value.auth_type==="ssh"&&!s.value.ssh_key&&!$.value);case 2:return!(s.value.sync_mode==="scheduled"&&!s.value.sync_interval||s.value.sync_mode==="webhook"&&!s.value.webhook_secret&&!V.value);default:return!0}});ie(()=>{U()});async function U(){S.value=!0;try{const o=await E.getList();o.success&&(i.value=o.data.map(t=>({...t,syncing:!1})))}catch(o){console.error("Failed to load repositories:",o)}finally{S.value=!1}}function F(){s.value={name:"",description:"",url:"",branch:"main",path:"",auth_type:"public",auth_token:"",ssh_key:"",sync_mode:"manual",sync_interval:60,sync_enabled:!0,enabled:!0,webhook_secret:"",webhook_url:""},x.value=!1,$.value=!1,V.value=!1,c.value=0}function H(){console.log("showAddDialog called"),F(),k.value=!1,M.value=null,r.value=!0,console.log("dialogVisible:",r.value)}async function q(o){F(),k.value=!0,M.value=o.id;try{const t=await E.getDetail(o.id,!0);if(t.success){const l=t.data;s.value={name:l.name||"",description:l.description||"",url:l.url||"",branch:l.branch||"main",path:l.path||"",auth_type:l.auth_type||"public",auth_token:"",ssh_key:"",sync_mode:l.sync_mode||"manual",sync_interval:l.sync_interval||60,sync_enabled:l.sync_enabled!==void 0?l.sync_enabled:!0,enabled:l.enabled!==void 0?l.enabled:!0,webhook_secret:"",webhook_url:l.webhook_url||""},x.value=l.has_auth_token||!1,$.value=l.has_ssh_key||!1,V.value=l.has_webhook_secret||!1}}catch(t){console.error("Failed to load repository detail:",t),m.error("加载仓库详情失败")}r.value=!0}function P(){r.value=!1}function K(){c.value<v.length-1&&c.value++}function Y(){c.value>0&&c.value--}async function Z(){if(!s.value.name||!s.value.url){m.warning("请填写仓库名称和地址"),c.value=0;return}if(s.value.auth_type==="token"&&!s.value.auth_token&&!x.value){m.warning("请提供访问令牌"),c.value=1;return}if(s.value.auth_type==="ssh"&&!s.value.ssh_key&&!$.value){m.warning("请提供SSH密钥"),c.value=1;return}if(s.value.sync_mode==="webhook"&&!s.value.webhook_secret&&!V.value){m.warning("请提供Webhook密钥"),c.value=2;return}w.value=!0;try{const o={...s.value};k.value&&(!o.auth_token&&x.value&&delete o.auth_token,!o.ssh_key&&$.value&&delete o.ssh_key,!o.webhook_secret&&V.value&&delete o.webhook_secret);let t;k.value?t=await E.update(M.value,o):t=await E.create(o),t.success?(m.success(k.value?"仓库更新成功":"仓库添加成功"),P(),U()):m.error(t.message||"操作失败")}catch(o){console.error("Failed to submit:",o),m.error("操作失败")}finally{w.value=!1}}async function J(o){o.syncing=!0;try{const t=await E.sync(o.id);t.success?(m.success(`同步成功: 新增 ${t.data.added} 个, 更新 ${t.data.updated} 个`),U()):m.error(t.message||"同步失败")}catch(t){console.error("Failed to sync repository:",t),m.error("同步失败")}finally{o.syncing=!1}}async function G(o){try{const t=await E.toggle(o.id);t.success?(m.success(t.message),U()):m.error(t.message||"操作失败")}catch(t){console.error("Failed to toggle repository:",t),m.error("操作失败")}}async function Q(o){if(confirm(`确定要删除仓库 "${o.name}" 吗？此操作不可恢复。`)){const t=await E.delete(o.id);t.success?(m.success("删除成功"),U()):m.error(t.message||"删除失败")}}function X(o){return{pending:"default",syncing:"warning",success:"success",failed:"error"}[o]||"default"}function ee(o){return{pending:"待同步",syncing:"同步中",success:"成功",failed:"失败"}[o]||o}function N(o){return{public:"公开仓库",token:"Token 认证",ssh:"SSH 密钥"}[o]||o}function O(o){return{manual:"手动同步",scheduled:"定时同步",webhook:"Webhook"}[o]||o}function te(o){if(!o)return"从未";const t=new Date(o),f=new Date-t,A=Math.floor(f/(1e3*60*60));if(A<1)return"刚刚";if(A<24)return`${A}小时前`;const W=Math.floor(A/24);return W<7?`${W}天前`:t.toLocaleDateString("zh-CN")}return(o,t)=>(n(),a(B,null,[e("div",pe,[e("div",me,[e("span",fe,d(i.value.length)+" 个仓库",1),e("button",{class:"btn btn--primary",onClick:H},[...t[17]||(t[17]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M12 5v14M5 12h14"})],-1),b(" 添加仓库 ",-1)])])]),e("div",be,[(n(!0),a(B,null,R(i.value,l=>(n(),a("div",{key:l.id,class:h(["repo-card",{"repo-card--disabled":!l.enabled}])},[e("div",_e,[e("div",ge,[t[18]||(t[18]=e("div",{class:"repo-card__icon"},[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[e("path",{d:"M3 7v10c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V9c0-1.1-.9-2-2-2h-6l-2-2H5c-1.1 0-2 .9-2 2z"})])],-1)),e("div",ye,[e("h3",he,[b(d(l.name)+" ",1),l.enabled?p("",!0):(n(),a("span",ke,"已禁用"))]),e("p",we,d(l.url),1),l.description?(n(),a("p",Ce,d(l.description),1)):p("",!0)])]),e("div",{class:h(["repo-card__status",`status--${X(l.sync_status)}`])},d(ee(l.sync_status)),3)]),l.branch||l.path?(n(),a("div",Me,[l.branch?(n(),a("span",xe,[t[19]||(t[19]=e("svg",{viewBox:"0 0 16 16",fill:"currentColor"},[e("path",{d:"M11 4H4v2h7V4z"}),e("path",{d:"M4 8h4v2H4V8z"}),e("path",{d:"M4 12h5v2H4v-2z"})],-1)),b(" "+d(l.branch),1)])):p("",!0),l.path?(n(),a("span",$e,[t[20]||(t[20]=e("svg",{viewBox:"0 0 16 16",fill:"currentColor"},[e("path",{d:"M14 1H2v14h12V1zM3 2h10v12H3V2z"})],-1)),b(" "+d(l.path),1)])):p("",!0),e("span",Se,[t[21]||(t[21]=e("svg",{viewBox:"0 0 16 16",fill:"currentColor"},[e("circle",{cx:"5",cy:"5",r:"3"}),e("path",{d:"M5 9a5 5 0 0 0-5 5h10a5 5 0 0 0-5-5z"})],-1)),b(" "+d(N(l.auth_type)),1)]),e("span",Ve,[t[22]||(t[22]=e("svg",{viewBox:"0 0 16 16",fill:"currentColor"},[e("path",{d:"M8 3a5 5 0 1 0 0 10 5 5 0 0 0 0-10z"})],-1)),b(" "+d(O(l.sync_mode)),1)])])):p("",!0),e("div",ze,[e("div",Ue,[e("span",Be,[e("strong",null,d(l.resource_count||0),1),t[23]||(t[23]=e("small",null,"资源",-1))]),e("span",He,[e("strong",null,d(te(l.last_sync_at)),1),t[24]||(t[24]=e("small",null,"最后同步",-1))])]),e("div",Ie,[e("button",{class:h(["icon-btn",{"icon-btn--active":l.enabled}]),onClick:f=>G(l),title:l.enabled?"禁用":"启用"},[(n(),a("svg",Le,[t[25]||(t[25]=e("circle",{cx:"12",cy:"12",r:"10"},null,-1)),l.enabled?(n(),a("path",Ae)):(n(),a("path",De))]))],10,Te),e("button",{class:"icon-btn",onClick:f=>J(l),disabled:!l.enabled||l.syncing,title:"同步"},[(n(),a("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5",class:h({spinning:l.syncing})},[...t[26]||(t[26]=[e("path",{d:"M23 4v6h-6M1 20v-6h6"},null,-1),e("path",{d:"M20.49 15a9 9 0 1 1-2.12-9.36L23 10"},null,-1)])],2))],8,Ee),e("button",{class:"icon-btn",onClick:f=>q(l),title:"编辑"},[...t[27]||(t[27]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[e("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),e("path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})],-1)])],8,Pe),e("button",{class:"icon-btn icon-btn--danger",onClick:f=>Q(l),title:"删除"},[...t[28]||(t[28]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[e("path",{d:"M3 6h18M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})],-1)])],8,Ge)])])],2))),128)),i.value.length===0&&!S.value?(n(),a("div",Re,[t[29]||(t[29]=e("svg",{viewBox:"0 0 64 64",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[e("path",{d:"M8 16v36c0 2.2 1.8 4 4 4h40c2.2 0 4-1.8 4-4V24c0-2.2-1.8-4-4-4H32l-4-4H12c-2.2 0-4 1.8-4 4z"})],-1)),t[30]||(t[30]=e("p",null,"暂无仓库",-1)),e("button",{class:"btn btn--primary",onClick:H},"添加第一个仓库")])):p("",!0)])]),j(ue,{name:"modal"},{default:re(()=>[r.value?(n(),a("div",{key:0,class:"modal-overlay",onClick:de(P,["self"])},[e("div",Fe,[e("div",qe,[(n(),a(B,null,R(v,(l,f)=>e("div",{key:f,class:h(["wizard-step",{"wizard-step--active":c.value===f,"wizard-step--completed":c.value>f}])},[e("div",Ne,[c.value>f?(n(),a("svg",Oe,[...t[31]||(t[31]=[e("path",{d:"M20 6L9 17l-5-5"},null,-1)])])):(n(),a("span",We,d(f+1),1))]),e("span",je,d(l.label),1)],2)),64))]),e("div",Ke,[u(e("div",Ye,[e("div",Ze,[t[32]||(t[32]=e("label",{class:"form-label"},[b("仓库名称 "),e("span",{class:"required"},"*")],-1)),u(e("input",{"onUpdate:modelValue":t[0]||(t[0]=l=>s.value.name=l),class:"form-input",placeholder:"例如：AI Skills Repository"},null,512),[[g,s.value.name]])]),e("div",Je,[t[33]||(t[33]=e("label",{class:"form-label"},[b("仓库地址 "),e("span",{class:"required"},"*")],-1)),u(e("input",{"onUpdate:modelValue":t[1]||(t[1]=l=>s.value.url=l),class:"form-input form-input--mono",placeholder:"https://gitlab.com/group/project",disabled:k.value},null,8,Qe),[[g,s.value.url]]),k.value?(n(),a("span",Xe,"仓库地址不可修改")):p("",!0)]),e("div",et,[t[34]||(t[34]=e("label",{class:"form-label"},"描述",-1)),u(e("textarea",{"onUpdate:modelValue":t[2]||(t[2]=l=>s.value.description=l),class:"form-textarea",rows:"2",placeholder:"简要描述仓库用途..."},null,512),[[g,s.value.description]])]),e("div",tt,[e("div",st,[t[35]||(t[35]=e("label",{class:"form-label"},"分支",-1)),u(e("input",{"onUpdate:modelValue":t[3]||(t[3]=l=>s.value.branch=l),class:"form-input form-input--mono",placeholder:"main"},null,512),[[g,s.value.branch]])]),e("div",lt,[t[36]||(t[36]=e("label",{class:"form-label"},"代码路径",-1)),u(e("input",{"onUpdate:modelValue":t[4]||(t[4]=l=>s.value.path=l),class:"form-input form-input--mono",placeholder:"src/skills"},null,512),[[g,s.value.path]])])])],512),[[L,c.value===0]]),u(e("div",ot,[e("div",nt,[t[46]||(t[46]=e("label",{class:"form-label"},"认证方式",-1)),e("div",at,[e("label",{class:h(["radio-card",{"radio-card--active":s.value.auth_type==="public"}])},[u(e("input",{type:"radio","onUpdate:modelValue":t[5]||(t[5]=l=>s.value.auth_type=l),value:"public"},null,512),[[T,s.value.auth_type]]),t[37]||(t[37]=e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[e("path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"})],-1)),t[38]||(t[38]=e("span",null,"公开仓库",-1)),t[39]||(t[39]=e("small",null,"无需认证",-1))],2),e("label",{class:h(["radio-card",{"radio-card--active":s.value.auth_type==="token"}])},[u(e("input",{type:"radio","onUpdate:modelValue":t[6]||(t[6]=l=>s.value.auth_type=l),value:"token"},null,512),[[T,s.value.auth_type]]),t[40]||(t[40]=e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[e("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2"}),e("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})],-1)),t[41]||(t[41]=e("span",null,"Token 认证",-1)),t[42]||(t[42]=e("small",null,"访问令牌",-1))],2),e("label",{class:h(["radio-card",{"radio-card--active":s.value.auth_type==="ssh"}])},[u(e("input",{type:"radio","onUpdate:modelValue":t[7]||(t[7]=l=>s.value.auth_type=l),value:"ssh"},null,512),[[T,s.value.auth_type]]),t[43]||(t[43]=e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[e("path",{d:"M4 17l6-6-6-6M12 19h8"})],-1)),t[44]||(t[44]=e("span",null,"SSH 密钥",-1)),t[45]||(t[45]=e("small",null,"SSH私钥",-1))],2)])]),s.value.auth_type==="token"?(n(),a("div",it,[t[47]||(t[47]=e("label",{class:"form-label"},[b("访问令牌 "),e("span",{class:"required"},"*")],-1)),u(e("input",{"onUpdate:modelValue":t[8]||(t[8]=l=>s.value.auth_token=l),type:"password",class:"form-input form-input--mono",placeholder:"glpat-xxxxxxxxxxxxxx"},null,512),[[g,s.value.auth_token]]),k.value&&x.value?(n(),a("span",rt,"留空保持原令牌不变")):p("",!0)])):p("",!0),s.value.auth_type==="ssh"?(n(),a("div",dt,[t[48]||(t[48]=e("label",{class:"form-label"},[b("SSH 私钥 "),e("span",{class:"required"},"*")],-1)),u(e("textarea",{"onUpdate:modelValue":t[9]||(t[9]=l=>s.value.ssh_key=l),class:"form-textarea form-textarea--mono",rows:"5",placeholder:"-----BEGIN RSA PRIVATE KEY-----"},null,512),[[g,s.value.ssh_key]]),k.value&&$.value?(n(),a("span",ut,"留空保持原密钥不变")):p("",!0)])):p("",!0)],512),[[L,c.value===1]]),u(e("div",ct,[e("div",vt,[t[58]||(t[58]=e("label",{class:"form-label"},"同步方式",-1)),e("div",pt,[e("label",{class:h(["radio-card",{"radio-card--active":s.value.sync_mode==="manual"}])},[u(e("input",{type:"radio","onUpdate:modelValue":t[10]||(t[10]=l=>s.value.sync_mode=l),value:"manual"},null,512),[[T,s.value.sync_mode]]),t[49]||(t[49]=e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[e("circle",{cx:"12",cy:"12",r:"10"}),e("path",{d:"M12 6v6l4 2"})],-1)),t[50]||(t[50]=e("span",null,"手动同步",-1)),t[51]||(t[51]=e("small",null,"手动触发",-1))],2),e("label",{class:h(["radio-card",{"radio-card--active":s.value.sync_mode==="scheduled"}])},[u(e("input",{type:"radio","onUpdate:modelValue":t[11]||(t[11]=l=>s.value.sync_mode=l),value:"scheduled"},null,512),[[T,s.value.sync_mode]]),t[52]||(t[52]=e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[e("path",{d:"M12 2v4M12 18v4M4.93 4.93l2.83 2.83M16.24 16.24l2.83 2.83M2 12h4M18 12h4"})],-1)),t[53]||(t[53]=e("span",null,"定时同步",-1)),t[54]||(t[54]=e("small",null,"自动定时",-1))],2),e("label",{class:h(["radio-card",{"radio-card--active":s.value.sync_mode==="webhook"}])},[u(e("input",{type:"radio","onUpdate:modelValue":t[12]||(t[12]=l=>s.value.sync_mode=l),value:"webhook"},null,512),[[T,s.value.sync_mode]]),t[55]||(t[55]=e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[e("path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"})],-1)),t[56]||(t[56]=e("span",null,"Webhook",-1)),t[57]||(t[57]=e("small",null,"推送触发",-1))],2)])]),s.value.sync_mode==="scheduled"?(n(),a("div",mt,[t[59]||(t[59]=e("label",{class:"form-label"},[b("同步间隔（分钟）"),e("span",{class:"required"},"*")],-1)),u(e("input",{"onUpdate:modelValue":t[13]||(t[13]=l=>s.value.sync_interval=l),type:"number",class:"form-input",min:"1",placeholder:"60"},null,512),[[g,s.value.sync_interval,void 0,{number:!0}]])])):p("",!0),s.value.sync_mode==="webhook"?(n(),a("div",ft,[e("div",bt,[t[60]||(t[60]=e("label",{class:"form-label"},[b("Webhook 密钥 "),e("span",{class:"required"},"*")],-1)),u(e("input",{"onUpdate:modelValue":t[14]||(t[14]=l=>s.value.webhook_secret=l),type:"password",class:"form-input form-input--mono",placeholder:"输入密钥"},null,512),[[g,s.value.webhook_secret]]),k.value&&V.value?(n(),a("span",_t,"留空保持原密钥不变")):p("",!0)]),e("div",gt,[t[61]||(t[61]=e("label",{class:"form-label"},"Webhook 回调地址",-1)),u(e("input",{"onUpdate:modelValue":t[15]||(t[15]=l=>s.value.webhook_url=l),class:"form-input form-input--mono",placeholder:"https://your-domain.com/webhook"},null,512),[[g,s.value.webhook_url]])])])):p("",!0)],512),[[L,c.value===2]]),u(e("div",yt,[e("div",ht,[e("div",kt,[t[67]||(t[67]=e("h4",null,"基础信息",-1)),e("div",wt,[t[62]||(t[62]=e("span",null,"仓库名称",-1)),e("strong",null,d(s.value.name||"-"),1)]),e("div",Ct,[t[63]||(t[63]=e("span",null,"仓库地址",-1)),e("strong",Mt,d(s.value.url||"-"),1)]),s.value.description?(n(),a("div",xt,[t[64]||(t[64]=e("span",null,"描述",-1)),e("strong",null,d(s.value.description),1)])):p("",!0),e("div",$t,[t[65]||(t[65]=e("span",null,"分支",-1)),e("strong",St,d(s.value.branch||"main"),1)]),s.value.path?(n(),a("div",Vt,[t[66]||(t[66]=e("span",null,"代码路径",-1)),e("strong",zt,d(s.value.path),1)])):p("",!0)]),e("div",Ut,[t[71]||(t[71]=e("h4",null,"认证配置",-1)),e("div",Bt,[t[68]||(t[68]=e("span",null,"认证方式",-1)),e("strong",null,d(N(s.value.auth_type)),1)]),s.value.auth_type==="token"?(n(),a("div",Ht,[t[69]||(t[69]=e("span",null,"访问令牌",-1)),e("strong",null,d(k.value&&x.value?"*** 已设置 ***":s.value.auth_token?"*** 已填写 ***":"-"),1)])):p("",!0),s.value.auth_type==="ssh"?(n(),a("div",It,[t[70]||(t[70]=e("span",null,"SSH密钥",-1)),e("strong",null,d(k.value&&$.value?"*** 已设置 ***":s.value.ssh_key?"*** 已填写 ***":"-"),1)])):p("",!0)]),e("div",Tt,[t[76]||(t[76]=e("h4",null,"同步配置",-1)),e("div",Lt,[t[72]||(t[72]=e("span",null,"同步方式",-1)),e("strong",null,d(O(s.value.sync_mode)),1)]),s.value.sync_mode==="scheduled"?(n(),a("div",At,[t[73]||(t[73]=e("span",null,"同步间隔",-1)),e("strong",null,d(s.value.sync_interval)+" 分钟",1)])):p("",!0),s.value.sync_mode==="webhook"&&s.value.webhook_url?(n(),a("div",Dt,[t[74]||(t[74]=e("span",null,"回调地址",-1)),e("strong",Et,d(s.value.webhook_url),1)])):p("",!0),e("div",Pt,[t[75]||(t[75]=e("span",null,"启用状态",-1)),e("strong",null,d(s.value.enabled?"启用":"禁用"),1)])])]),e("div",Gt,[e("label",Rt,[u(e("input",{type:"checkbox","onUpdate:modelValue":t[16]||(t[16]=l=>s.value.enabled=l)},null,512),[[se,s.value.enabled]]),t[77]||(t[77]=e("div",{class:"checkbox-content"},[e("strong",null,"启用此仓库"),e("small",null,"禁用后仓库将不会参与任何同步操作")],-1))])])],512),[[L,c.value===3]])]),e("div",Ft,[c.value>0?(n(),a("button",{key:0,class:"btn btn--secondary",onClick:Y},[...t[78]||(t[78]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M19 12H5M12 19l-7-7 7-7"})],-1),b(" 上一步 ",-1)])])):(n(),a("div",qt)),e("div",Nt,[e("button",{class:"btn btn--secondary",onClick:P},"取消"),c.value<v.length-1?(n(),a("button",{key:0,class:"btn btn--primary",onClick:K,disabled:!z.value},[...t[79]||(t[79]=[b(" 下一步 ",-1),e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M5 12h14M12 5l7 7-7 7"})],-1)])],8,Ot)):(n(),a("button",{key:1,class:"btn btn--primary",onClick:Z,disabled:w.value},[w.value?p("",!0):(n(),a("svg",jt,[...t[80]||(t[80]=[e("path",{d:"M5 13l4 4L19 7"},null,-1)])])),w.value?(n(),a("span",Kt,"提交中...")):(n(),a("span",Yt,"完成配置"))],8,Wt))])])])])):p("",!0)]),_:1})],64))}},Jt=le(Zt,[["__scopeId","data-v-f453b5bc"]]),Qt={class:"mcp-manage-page"},Xt={class:"action-bar"},es={class:"server-count"},ts={class:"server-list"},ss={class:"server-card__header"},ls={class:"server-card__left"},os={class:"server-card__info"},ns={class:"server-card__name"},as={key:0,class:"badge badge--disabled"},is={key:0,class:"server-card__description"},rs={class:"server-card__meta"},ds={key:0,class:"meta-tag"},us={key:1,class:"meta-tag"},cs={class:"meta-tag"},vs={class:"server-card__footer"},ps={class:"server-stats"},ms={class:"stat"},fs={class:"stat"},bs={class:"server-actions"},_s=["onClick","title"],gs={viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},ys={key:0,d:"M12 6v12M8 10l4 4 4-4"},hs={key:1,d:"M15 9l-6 6M9 9l6 6"},ks=["onClick","disabled"],ws=["onClick"],Cs=["onClick"],Ms={key:0,class:"empty-state"},xs={class:"dialog-modal dialog-modal--wizard"},$s={class:"dialog-header"},Ss={class:"wizard-steps"},Vs={class:"wizard-step__circle"},zs={key:0,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2.5"},Us={key:1},Bs={class:"wizard-step__label"},Hs={class:"dialog-body dialog-body--wizard"},Is={class:"wizard-panel"},Ts={class:"form-field"},Ls={class:"form-field"},As={class:"wizard-panel"},Ds={class:"radio-cards"},Es={class:"wizard-panel"},Ps={class:"wizard-panel__desc"},Gs={class:"form-field"},Rs={class:"form-field"},Fs={class:"form-field"},qs={key:1,class:"form-field"},Ns={class:"form-field"},Os={class:"wizard-panel"},Ws={class:"config-summary"},js={class:"config-section"},Ks={class:"config-item"},Ys={class:"config-item__value"},Zs={key:0,class:"config-item"},Js={class:"config-item__value"},Qs={class:"config-section"},Xs={class:"config-item"},el={class:"config-section"},tl={class:"config-item"},sl={class:"config-item__value config-item__value--mono"},ll={key:0,class:"config-item"},ol={class:"config-item__value config-item__value--mono"},nl={key:1,class:"config-item"},al={class:"config-item__value config-item__value--mono"},il={key:1,class:"config-item"},rl={class:"config-item__value config-item__value--mono"},dl={class:"config-item"},ul={class:"config-item__value"},cl={class:"config-section"},vl={class:"config-item"},pl={class:"dialog-footer dialog-footer--wizard"},ml=["disabled"],fl={key:0,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},bl={key:1},_l={key:2},gl={__name:"MCPServerManage",setup(y){const i=_([]),S=_(!1),r=_(!1),k=_(!1),w=_(!1),M=_(null),c=_(0),v=["基础信息","传输配置","连接配置","确认配置"],s=_({name:"",description:"",transport_type:"stdio",command:"",arguments_str:"",env_str:"",url:"",timeout:30,enabled:!0});function x(o){return!o||!o.trim()?[]:o.trim().split(/\s+/).filter(t=>t.length>0)}function $(o){return!o||!Array.isArray(o)||o.length===0?"":o.join(" ")}function V(o){if(!o||!o.trim())return{};const t={};return o.trim().split(`
`).forEach(l=>{if(l=l.trim(),l&&l.includes("=")){const f=l.indexOf("="),A=l.substring(0,f).trim(),W=l.substring(f+1).trim();A&&(t[A]=W)}}),t}function z(o){return!o||Object.keys(o).length===0?"":Object.entries(o).map(([t,l])=>`${t}=${l}`).join(`
`)}function U(){return{name:s.value.name,description:s.value.description,transport_type:s.value.transport_type,command:s.value.command,arguments:x(s.value.arguments_str),env:V(s.value.env_str),url:s.value.url,timeout:s.value.timeout,enabled:s.value.enabled}}function F(o){return{name:o.name||"",description:o.description||"",transport_type:o.transport_type||"stdio",command:o.command||"",arguments_str:$(o.arguments),env_str:z(o.env),url:o.url||"",timeout:o.timeout||30,enabled:o.enabled!==void 0?o.enabled:!0}}ie(()=>{H()});async function H(){S.value=!0;try{const o=await D.getServers();o.success&&(i.value=o.data.map(t=>({...t,syncing:!1})))}catch(o){console.error("Failed to load servers:",o)}finally{S.value=!1}}function q(){s.value={name:"",description:"",transport_type:"stdio",command:"",arguments_str:"",env_str:"",url:"",timeout:30,enabled:!0},c.value=0}function P(){q(),k.value=!1,M.value=null,r.value=!0}function K(){Z(c.value)&&c.value++}function Y(){c.value>0&&c.value--}function Z(o){switch(o){case 0:return!s.value.name||!s.value.name.trim()?(m.warning("请输入 Server 名称"),!1):!0;case 1:return s.value.transport_type?!0:(m.warning("请选择传输类型"),!1);case 2:return s.value.transport_type==="stdio"&&!s.value.command?(m.warning("请输入启动命令"),!1):s.value.transport_type==="http"&&!s.value.url?(m.warning("请输入 Server URL"),!1):!s.value.timeout||s.value.timeout<5?(m.warning("请输入有效的超时时间"),!1):!0;default:return!0}}async function J(o){q(),k.value=!0,M.value=o.id;try{const t=await D.getServer(o.id,!0);t.success&&(s.value=F(t.data))}catch(t){console.error("Failed to load server detail:",t),m.error("加载 Server 详情失败")}c.value=0,r.value=!0}function G(){r.value=!1,c.value=0}async function Q(){w.value=!0;try{const o=U();let t;k.value?t=await D.update(M.value,o):t=await D.create(o),t.success?(m.success(k.value?"Server 更新成功":"Server 添加成功"),G(),H()):m.error(t.message||"操作失败")}catch(o){console.error("Failed to submit:",o),m.error("操作失败")}finally{w.value=!1}}async function X(o){o.syncing=!0;try{const t=await D.sync(o.id);t.success?(m.success(`同步成功: ${t.data.tool_count} Tools, ${t.data.resource_count} Resources`),H()):m.error(t.message||"同步失败")}catch(t){console.error("Failed to sync server:",t),m.error("同步失败")}finally{o.syncing=!1}}async function ee(o){try{const t=await D.toggle(o.id);t.success?(m.success(t.message),H()):m.error(t.message||"操作失败")}catch(t){console.error("Failed to toggle server:",t),m.error("操作失败")}}async function N(o){if(confirm(`确定要删除 Server "${o.name}" 吗？此操作不可恢复。`))try{const t=await D.delete(o.id);t.success?(m.success("删除成功"),H()):m.error(t.message||"删除失败")}catch(t){console.error("Failed to delete server:",t),m.error("删除失败")}}function O(o){return o.syncing?"warning":o.enabled&&o.total_tools>0?"success":"default"}function te(o){return o.syncing?"同步中":o.enabled?o.total_tools>0?"已同步":"待同步":"已禁用"}return(o,t)=>(n(),a(B,null,[e("div",Qt,[e("div",Xt,[e("span",es,d(i.value.length)+" 个 Server",1),e("button",{class:"btn btn--primary",onClick:P},[...t[9]||(t[9]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M12 5v14M5 12h14"})],-1),b(" 添加 Server ",-1)])])]),e("div",ts,[(n(!0),a(B,null,R(i.value,l=>(n(),a("div",{key:l.id,class:h(["server-card",{"server-card--disabled":!l.enabled}])},[e("div",ss,[e("div",ls,[t[10]||(t[10]=e("div",{class:"server-card__icon"},[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[e("rect",{x:"4",y:"4",width:"16",height:"16",rx:"2"}),e("circle",{cx:"12",cy:"12",r:"4"})])],-1)),e("div",os,[e("h3",ns,[b(d(l.name)+" ",1),l.enabled?p("",!0):(n(),a("span",as,"已禁用")),e("span",{class:h(["badge",`badge--${l.transport_type}`])},d(l.transport_type.toUpperCase()),3)]),l.description?(n(),a("p",is,d(l.description),1)):p("",!0)])]),e("div",{class:h(["server-card__status",`status--${O(l)}`])},d(te(l)),3)]),e("div",rs,[l.transport_type==="stdio"?(n(),a("span",ds,[t[11]||(t[11]=ve('<svg viewBox="0 0 16 16" fill="currentColor" data-v-b2b30c9c><path d="M4 2h8v2H4z" data-v-b2b30c9c></path><path d="M2 6h12v2H2z" data-v-b2b30c9c></path><path d="M2 10h12v2H2z" data-v-b2b30c9c></path><path d="M4 14h8v2H4z" data-v-b2b30c9c></path></svg>',1)),b(" "+d(l.command||"未知命令"),1)])):p("",!0),l.transport_type==="http"?(n(),a("span",us,[t[12]||(t[12]=e("svg",{viewBox:"0 0 16 16",fill:"currentColor"},[e("path",{d:"M8 0a8 8 0 100 16A8 8 0 008 0zm0 14.5a6.5 6.5 0 110-13 6.5 6.5 0 010 13z"}),e("path",{d:"M8 4a4 4 0 100 8 4 4 0 000-8z"})],-1)),b(" "+d(l.url||"未知 URL"),1)])):p("",!0),e("span",cs,[t[13]||(t[13]=e("svg",{viewBox:"0 0 16 16",fill:"currentColor"},[e("path",{d:"M8 3a5 5 0 015 5h-2a3 3 0 00-3-3V3z"}),e("path",{d:"M8 13a5 5 0 01-5-5h2a3 3 0 003 3v2z"}),e("path",{d:"M13 8a5 5 0 01-5 5v-2a3 3 0 003-3h2z"})],-1)),b(" "+d(l.timeout||30)+"s 超时 ",1)])]),e("div",vs,[e("div",ps,[e("span",ms,[e("strong",null,d(l.total_tools||0),1),t[14]||(t[14]=e("small",null,"Tools",-1))]),e("span",fs,[e("strong",null,d(l.total_resources||0),1),t[15]||(t[15]=e("small",null,"Resources",-1))])]),e("div",bs,[e("button",{class:h(["icon-btn",{"icon-btn--active":l.enabled}]),onClick:f=>ee(l),title:l.enabled?"禁用":"启用"},[(n(),a("svg",gs,[t[16]||(t[16]=e("circle",{cx:"12",cy:"12",r:"10"},null,-1)),l.enabled?(n(),a("path",ys)):(n(),a("path",hs))]))],10,_s),e("button",{class:"icon-btn",onClick:f=>X(l),disabled:!l.enabled||l.syncing,title:"同步"},[(n(),a("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5",class:h({spinning:l.syncing})},[...t[17]||(t[17]=[e("path",{d:"M23 4v6h-6M1 20v-6h6"},null,-1),e("path",{d:"M20.49 15a9 9 0 1 1-2.12-9.36L23 10"},null,-1)])],2))],8,ks),e("button",{class:"icon-btn",onClick:f=>J(l),title:"编辑"},[...t[18]||(t[18]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[e("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),e("path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})],-1)])],8,ws),e("button",{class:"icon-btn icon-btn--danger",onClick:f=>N(l),title:"删除"},[...t[19]||(t[19]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[e("path",{d:"M3 6h18M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})],-1)])],8,Cs)])])],2))),128)),i.value.length===0&&!S.value?(n(),a("div",Ms,[t[20]||(t[20]=e("svg",{viewBox:"0 0 64 64",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[e("rect",{x:"12",y:"12",width:"40",height:"40",rx:"4"}),e("circle",{cx:"32",cy:"32",r:"8"}),e("path",{d:"M32 8v8M32 48v8M8 32h8M48 32h8"})],-1)),t[21]||(t[21]=e("p",null,"暂无 MCP Server",-1)),e("button",{class:"btn btn--primary",onClick:P},"添加第一个 Server")])):p("",!0)])]),j(ue,{name:"modal"},{default:re(()=>[r.value?(n(),a("div",{key:0,class:"modal-overlay",onClick:de(G,["self"])},[e("div",xs,[e("div",$s,[e("h3",null,d(k.value?"编辑":"添加")+" MCP Server",1),e("button",{class:"dialog-close",onClick:G},[...t[22]||(t[22]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[e("path",{d:"M18 6L6 18M6 6l12 12"})],-1)])])]),e("div",Ss,[(n(),a(B,null,R(v,(l,f)=>e("div",{key:f,class:h(["wizard-step",{"wizard-step--active":c.value===f,"wizard-step--completed":c.value>f}])},[e("div",Vs,[c.value>f?(n(),a("svg",zs,[...t[23]||(t[23]=[e("path",{d:"M5 13l4 4L19 7"},null,-1)])])):(n(),a("span",Us,d(f+1),1))]),e("span",Bs,d(l),1)],2)),64))]),e("div",Hs,[u(e("div",Is,[t[26]||(t[26]=e("div",{class:"wizard-panel__title"},"基础信息",-1)),t[27]||(t[27]=e("div",{class:"wizard-panel__desc"},"配置 MCP Server 的基本识别信息",-1)),e("div",Ts,[t[24]||(t[24]=e("label",{class:"form-label"},[b("Server 名称 "),e("span",{class:"required"},"*")],-1)),u(e("input",{"onUpdate:modelValue":t[0]||(t[0]=l=>s.value.name=l),class:"form-input",placeholder:"例如: Filesystem MCP"},null,512),[[g,s.value.name]])]),e("div",Ls,[t[25]||(t[25]=e("label",{class:"form-label"},"描述",-1)),u(e("textarea",{"onUpdate:modelValue":t[1]||(t[1]=l=>s.value.description=l),class:"form-textarea",rows:"5",placeholder:"描述此 MCP Server 的用途和功能..."},null,512),[[g,s.value.description]])])],512),[[L,c.value===0]]),u(e("div",As,[t[34]||(t[34]=e("div",{class:"wizard-panel__title"},"传输配置",-1)),t[35]||(t[35]=e("div",{class:"wizard-panel__desc"},"选择 MCP Server 的通信方式",-1)),e("div",Ds,[e("label",{class:h(["radio-card",{"radio-card--active":s.value.transport_type==="stdio"}])},[u(e("input",{type:"radio","onUpdate:modelValue":t[2]||(t[2]=l=>s.value.transport_type=l),value:"stdio"},null,512),[[T,s.value.transport_type]]),t[28]||(t[28]=e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[e("path",{d:"M4 4v16h16V4H4z"}),e("path",{d:"M9 9h6M9 13h6M9 5v14"})],-1)),t[29]||(t[29]=e("span",null,"stdio",-1)),t[30]||(t[30]=e("small",null,"标准输入输出",-1))],2),e("label",{class:h(["radio-card",{"radio-card--active":s.value.transport_type==="http"}])},[u(e("input",{type:"radio","onUpdate:modelValue":t[3]||(t[3]=l=>s.value.transport_type=l),value:"http"},null,512),[[T,s.value.transport_type]]),t[31]||(t[31]=e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[e("circle",{cx:"12",cy:"12",r:"10"}),e("path",{d:"M2 12h2M20 12h2M12 2v2M12 20v2"})],-1)),t[32]||(t[32]=e("span",null,"http",-1)),t[33]||(t[33]=e("small",null,"HTTP 传输",-1))],2)])],512),[[L,c.value===1]]),u(e("div",Es,[t[46]||(t[46]=e("div",{class:"wizard-panel__title"},"连接配置",-1)),e("div",Ps,"配置 "+d(s.value.transport_type==="stdio"?"命令行":"HTTP")+" 连接参数",1),s.value.transport_type==="stdio"?(n(),a(B,{key:0},[e("div",Gs,[t[36]||(t[36]=e("label",{class:"form-label"},[b("启动命令 "),e("span",{class:"required"},"*")],-1)),u(e("input",{"onUpdate:modelValue":t[4]||(t[4]=l=>s.value.command=l),class:"form-input form-input--mono",placeholder:"npx"},null,512),[[g,s.value.command]]),t[37]||(t[37]=e("small",{class:"form-hint"},"MCP Server 的启动命令，如 npx, node, python 等",-1))]),e("div",Rs,[t[38]||(t[38]=e("label",{class:"form-label"},"命令参数",-1)),u(e("input",{"onUpdate:modelValue":t[5]||(t[5]=l=>s.value.arguments_str=l),class:"form-input form-input--mono",placeholder:"-y @modelcontextprotocol/server-filesystem /path"},null,512),[[g,s.value.arguments_str]]),t[39]||(t[39]=e("small",{class:"form-hint"},"命令行参数，多个参数用空格分隔",-1))]),e("div",Fs,[t[40]||(t[40]=e("label",{class:"form-label"},"环境变量 (每行一个 KEY=VALUE)",-1)),u(e("textarea",{"onUpdate:modelValue":t[6]||(t[6]=l=>s.value.env_str=l),class:"form-textarea form-textarea--mono",rows:"3",placeholder:`NODE_ENV=production
API_KEY=your_key`},null,512),[[g,s.value.env_str]]),t[41]||(t[41]=e("small",{class:"form-hint"},"需要传递给 MCP Server 进程的环境变量",-1))])],64)):p("",!0),s.value.transport_type==="http"?(n(),a("div",qs,[t[42]||(t[42]=e("label",{class:"form-label"},[b("Server URL "),e("span",{class:"required"},"*")],-1)),u(e("input",{"onUpdate:modelValue":t[7]||(t[7]=l=>s.value.url=l),class:"form-input form-input--mono",placeholder:"https://example.com/mcp"},null,512),[[g,s.value.url]]),t[43]||(t[43]=e("small",{class:"form-hint"},"MCP Server 的 HTTP 服务地址",-1))])):p("",!0),e("div",Ns,[t[44]||(t[44]=e("label",{class:"form-label"},"超时时间 (秒)",-1)),u(e("input",{"onUpdate:modelValue":t[8]||(t[8]=l=>s.value.timeout=l),type:"number",class:"form-input",min:"5",max:"300"},null,512),[[g,s.value.timeout,void 0,{number:!0}]]),t[45]||(t[45]=e("small",{class:"form-hint"},"连接和操作的超时时间",-1))])],512),[[L,c.value===2]]),u(e("div",Os,[t[60]||(t[60]=e("div",{class:"wizard-panel__title"},"确认配置",-1)),t[61]||(t[61]=e("div",{class:"wizard-panel__desc"},"请确认以下配置信息无误",-1)),e("div",Ws,[e("div",js,[t[49]||(t[49]=e("div",{class:"config-section__title"},"基础信息",-1)),e("div",Ks,[t[47]||(t[47]=e("span",{class:"config-item__label"},"Server 名称",-1)),e("span",Ys,d(s.value.name||"-"),1)]),s.value.description?(n(),a("div",Zs,[t[48]||(t[48]=e("span",{class:"config-item__label"},"描述",-1)),e("span",Js,d(s.value.description),1)])):p("",!0)]),e("div",Qs,[t[51]||(t[51]=e("div",{class:"config-section__title"},"传输配置",-1)),e("div",Xs,[t[50]||(t[50]=e("span",{class:"config-item__label"},"传输类型",-1)),e("span",{class:h(["config-item__value config-item__value--badge",`badge--${s.value.transport_type}`])},d(s.value.transport_type.toUpperCase()),3)])]),e("div",el,[t[57]||(t[57]=e("div",{class:"config-section__title"},"连接配置",-1)),s.value.transport_type==="stdio"?(n(),a(B,{key:0},[e("div",tl,[t[52]||(t[52]=e("span",{class:"config-item__label"},"启动命令",-1)),e("span",sl,d(s.value.command||"-"),1)]),s.value.arguments_str?(n(),a("div",ll,[t[53]||(t[53]=e("span",{class:"config-item__label"},"命令参数",-1)),e("span",ol,d(s.value.arguments_str),1)])):p("",!0),s.value.env_str?(n(),a("div",nl,[t[54]||(t[54]=e("span",{class:"config-item__label"},"环境变量",-1)),e("span",al,d(s.value.env_str),1)])):p("",!0)],64)):p("",!0),s.value.transport_type==="http"?(n(),a("div",il,[t[55]||(t[55]=e("span",{class:"config-item__label"},"Server URL",-1)),e("span",rl,d(s.value.url||"-"),1)])):p("",!0),e("div",dl,[t[56]||(t[56]=e("span",{class:"config-item__label"},"超时时间",-1)),e("span",ul,d(s.value.timeout)+" 秒",1)])]),e("div",cl,[t[59]||(t[59]=e("div",{class:"config-section__title"},"状态配置",-1)),e("div",vl,[t[58]||(t[58]=e("span",{class:"config-item__label"},"启用状态",-1)),e("span",{class:h(["config-item__value config-item__value--status",s.value.enabled?"status-enabled":"status-disabled"])},d(s.value.enabled?"启用":"禁用"),3)])])])],512),[[L,c.value===3]])]),e("div",pl,[c.value>0?(n(),a("button",{key:0,class:"btn btn--secondary",onClick:Y},[...t[62]||(t[62]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M15 18l-6-6 6-6"})],-1),b(" 上一步 ",-1)])])):(n(),a("button",{key:1,class:"btn btn--secondary",onClick:G},"取消")),c.value<v.length-1?(n(),a("button",{key:2,class:"btn btn--primary",onClick:K},[...t[63]||(t[63]=[b(" 下一步 ",-1),e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M9 18l6-6-6-6"})],-1)])])):(n(),a("button",{key:3,class:"btn btn--primary",onClick:Q,disabled:w.value},[w.value?p("",!0):(n(),a("svg",fl,[...t[64]||(t[64]=[e("path",{d:"M5 13l4 4L19 7"},null,-1)])])),w.value?(n(),a("span",bl,"保存中...")):(n(),a("span",_l,"完成"))],8,ml))])])])):p("",!0)]),_:1})],64))}},yl=le(gl,[["__scopeId","data-v-b2b30c9c"]]),hl={render(){return C("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[C("path",{d:"M17 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2"}),C("circle",{cx:"9",cy:"7",r:"4"})])}},kl={render(){return C("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[C("path",{d:"M12 15a3 3 0 100-6 3 3 0 000 6z"}),C("path",{d:"M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 010 2.83 2 2 0 01-2.83 0l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-2 2 2 2 0 01-2-2v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83 0 2 2 0 010-2.83l.06-.06a1.65 1.65 0 00.33-1.82 1.65 1.65 0 00-1.51-1H3a2 2 0 01-2-2 2 2 0 012-2h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 010-2.83 2 2 0 012.83 0l.06.06a1.65 1.65 0 001.82.33H9a1.65 1.65 0 001-1.51V3a2 2 0 012-2 2 2 0 012 2v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 0 2 2 0 010 2.83l-.06.06a1.65 1.65 0 00-.33 1.82V9a1.65 1.65 0 001.51 1H21a2 2 0 012 2 2 2 0 01-2 2h-.09a1.65 1.65 0 00-1.51 1z"})])}},wl={render(){return C("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[C("path",{d:"M3 7V17C3 18.1046 3.89543 19 5 19H19C20.1046 19 21 18.1046 21 17V9C21 7.89543 20.1046 7 19 7H13L11 5H5C3.89543 5 3 5.89543 3 7Z"})])}},Cl={render(){return C("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[C("rect",{x:"4",y:"4",width:"16",height:"16",rx:"2"}),C("circle",{cx:"12",cy:"12",r:"4"})])}},Ml={render(){return C("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[C("path",{d:"M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z"}),C("path",{d:"M12 16V12"}),C("path",{d:"M12 8H12.01"})])}},xl={components:{UsersIcon:hl,RolesIcon:kl,ReposIcon:wl,McpIcon:Cl,OAuthIcon:Ml,RepositoryManage:Jt,MCPServerManage:yl},setup(){const y=_("oauth"),i=[{key:"oauth",label:"OAuth",icon:"OAuthIcon"},{key:"users",label:"用户",icon:"UsersIcon"},{key:"roles",label:"角色",icon:"RolesIcon"},{key:"repos",label:"Skills仓库",icon:"ReposIcon"},{key:"mcp",label:"MCP",icon:"McpIcon"}],S=_(!0),r=_({url:"https://gitlab.com",clientId:"",clientSecret:"",redirectUri:"http://localhost:3000/auth/callback"}),k=_(!1),w=_({clientId:"",clientSecret:"",redirectUri:"http://localhost:3000/auth/callback"});function M(){console.log("保存 GitLab 配置:",r.value)}function c(){console.log("测试 GitLab 连接")}function v(){console.log("保存 GitHub 配置:",w.value)}function s(){console.log("测试 GitHub 连接")}function x(){const z=i.find(U=>U.key===y.value);return(z==null?void 0:z.icon)||"UsersIcon"}function $(){return{users:"用户管理",roles:"角色管理",repos:"仓库管理",mcp:"MCP Server"}[y.value]||"开发中"}function V(){return{users:"管理系统用户和权限",roles:"定义角色和权限策略",repos:"管理 GitLab 仓库",mcp:"配置 MCP 服务器"}[y.value]||"功能开发中"}return{activeTab:y,menuItems:i,gitlabEnabled:S,gitlabConfig:r,githubEnabled:k,githubConfig:w,saveGitLabConfig:M,testGitLabConfig:c,saveGitHubConfig:v,testGitHubConfig:s,getCurrentIcon:x,getCurrentTitle:$,getCurrentDesc:V}}},$l={class:"admin-page"},Sl={class:"sidebar"},Vl={class:"sidebar-nav"},zl=["onClick"],Ul={class:"sidebar-text"},Bl={class:"main-content"},Hl={key:0,class:"content-section"},Il={class:"oauth-container"},Tl={class:"oauth-card"},Ll={class:"oauth-header"},Al={class:"switch"},Dl={key:0,class:"oauth-fields"},El={class:"field"},Pl={class:"field"},Gl={class:"field"},Rl={class:"field"},Fl={class:"actions"},ql={class:"oauth-card"},Nl={class:"oauth-header"},Ol={class:"switch"},Wl={key:0,class:"oauth-fields"},jl={class:"field"},Kl={class:"field"},Yl={class:"field"},Zl={class:"actions"},Jl={key:1,class:"content-section repos-section"},Ql={key:2,class:"content-section"},Xl={key:3,class:"content-section"},eo={class:"placeholder"},to={class:"placeholder-icon"};function so(y,i,S,r,k,w){const M=ae("RepositoryManage"),c=ae("MCPServerManage");return n(),a("div",$l,[e("aside",Sl,[e("nav",Vl,[(n(!0),a(B,null,R(r.menuItems,v=>(n(),a("button",{key:v.key,class:h(["sidebar-item",{active:r.activeTab===v.key}]),onClick:s=>r.activeTab=v.key},[(n(),oe(ne(v.icon),{class:"sidebar-icon"})),e("span",Ul,d(v.label),1)],10,zl))),128))])]),e("main",Bl,[r.activeTab==="oauth"?(n(),a("div",Hl,[e("div",Il,[e("div",Tl,[e("div",Ll,[i[14]||(i[14]=e("div",{class:"oauth-brand gitlab"},[e("svg",{viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M22.65 14.39L12 22.13 1.35 14.39a.84.84 0 01-.3-.94l1.22-3.78 2.44-7.51A.42.42 0 015 1.8a.43.43 0 01.41 0l2.44 7.51h8.3l2.44-7.51a.43.43 0 01.41 0 .42.42 0 01.33.36l2.44 7.51 1.22 3.78a.84.84 0 01-.3.94z"})]),e("span",null,"GitLab")],-1)),e("label",Al,[u(e("input",{type:"checkbox","onUpdate:modelValue":i[0]||(i[0]=v=>r.gitlabEnabled=v)},null,512),[[se,r.gitlabEnabled]]),i[13]||(i[13]=e("span",{class:"slider"},null,-1))])]),r.gitlabEnabled?(n(),a("div",Dl,[e("div",El,[i[15]||(i[15]=e("label",null,"URL",-1)),u(e("input",{"onUpdate:modelValue":i[1]||(i[1]=v=>r.gitlabConfig.url=v),placeholder:"https://gitlab.com"},null,512),[[g,r.gitlabConfig.url]])]),e("div",Pl,[i[16]||(i[16]=e("label",null,"Application ID",-1)),u(e("input",{"onUpdate:modelValue":i[2]||(i[2]=v=>r.gitlabConfig.clientId=v),placeholder:"Application ID"},null,512),[[g,r.gitlabConfig.clientId]])]),e("div",Gl,[i[17]||(i[17]=e("label",null,"Secret",-1)),u(e("input",{"onUpdate:modelValue":i[3]||(i[3]=v=>r.gitlabConfig.clientSecret=v),type:"password",placeholder:"Secret"},null,512),[[g,r.gitlabConfig.clientSecret]])]),e("div",Rl,[i[18]||(i[18]=e("label",null,"回调地址",-1)),u(e("input",{"onUpdate:modelValue":i[4]||(i[4]=v=>r.gitlabConfig.redirectUri=v),placeholder:"http://localhost:3000/auth/callback"},null,512),[[g,r.gitlabConfig.redirectUri]])]),e("div",Fl,[e("button",{class:"btn-primary",onClick:i[5]||(i[5]=(...v)=>r.saveGitLabConfig&&r.saveGitLabConfig(...v))},"保存"),e("button",{class:"btn-ghost",onClick:i[6]||(i[6]=(...v)=>r.testGitLabConfig&&r.testGitLabConfig(...v))},"测试")])])):p("",!0)]),e("div",ql,[e("div",Nl,[i[20]||(i[20]=e("div",{class:"oauth-brand github"},[e("svg",{viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M12 0C5.374 0 0 5.373 0 12c0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23A11.509 11.509 0 0112 5.803c1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576C20.566 21.797 24 17.3 24 12c0-6.627-5.373-12-12-12z"})]),e("span",null,"GitHub")],-1)),e("label",Ol,[u(e("input",{type:"checkbox","onUpdate:modelValue":i[7]||(i[7]=v=>r.githubEnabled=v)},null,512),[[se,r.githubEnabled]]),i[19]||(i[19]=e("span",{class:"slider"},null,-1))])]),r.githubEnabled?(n(),a("div",Wl,[e("div",jl,[i[21]||(i[21]=e("label",null,"Client ID",-1)),u(e("input",{"onUpdate:modelValue":i[8]||(i[8]=v=>r.githubConfig.clientId=v),placeholder:"Client ID"},null,512),[[g,r.githubConfig.clientId]])]),e("div",Kl,[i[22]||(i[22]=e("label",null,"Client Secret",-1)),u(e("input",{"onUpdate:modelValue":i[9]||(i[9]=v=>r.githubConfig.clientSecret=v),type:"password",placeholder:"Client Secret"},null,512),[[g,r.githubConfig.clientSecret]])]),e("div",Yl,[i[23]||(i[23]=e("label",null,"回调地址",-1)),u(e("input",{"onUpdate:modelValue":i[10]||(i[10]=v=>r.githubConfig.redirectUri=v),placeholder:"http://localhost:3000/auth/callback"},null,512),[[g,r.githubConfig.redirectUri]])]),e("div",Zl,[e("button",{class:"btn-primary",onClick:i[11]||(i[11]=(...v)=>r.saveGitHubConfig&&r.saveGitHubConfig(...v))},"保存"),e("button",{class:"btn-ghost",onClick:i[12]||(i[12]=(...v)=>r.testGitHubConfig&&r.testGitHubConfig(...v))},"测试")])])):p("",!0)])])])):p("",!0),r.activeTab==="repos"?(n(),a("div",Jl,[j(M)])):p("",!0),r.activeTab==="mcp"?(n(),a("div",Ql,[j(c)])):(n(),a("div",Xl,[e("div",eo,[e("div",to,[(n(),oe(ne(r.getCurrentIcon())))]),e("h3",null,d(r.getCurrentTitle()),1),e("p",null,d(r.getCurrentDesc()),1)])]))])])}const ao=le(xl,[["render",so],["__scopeId","data-v-1c1607ad"]]);export{ao as default};
