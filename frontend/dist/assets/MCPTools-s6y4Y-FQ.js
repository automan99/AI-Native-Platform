import{_ as K,g as W,o,c as a,b as e,n as k,e as f,t as r,w as S,A as X,F as z,m as L,v as U,h as v,p as R,l as T,B as A,k as Y,r as d,x as m,y as Z}from"./index-B70JlMxX.js";import{m as F}from"./mcp-CYPAatcg.js";import{n as q}from"./notification-D4aQ7HzA.js";const ee={class:"mcp-tools-page"},se={class:"tab-bar"},te={class:"tab-count"},oe={class:"tab-count"},le={key:0,class:"tab-content"},ae={class:"filter-bar"},re={class:"filter-group"},ne=["value"],ie={class:"search-group"},de={key:0,class:"loading-state"},ve={key:1,class:"empty-state"},ue={key:0},ce={key:1},pe={key:2,class:"tools-grid"},ke=["onClick"],fe={class:"tool-header"},he={class:"tool-name"},ye={class:"tool-description"},me={class:"tool-server"},_e={class:"tool-footer"},we={key:0,class:"tool-calls"},Me={key:1,class:"tool-schema"},Ce={key:1,class:"tab-content"},xe={class:"filter-bar"},ge={class:"search-group"},be={key:0,class:"loading-state"},Be={key:1,class:"empty-state"},Se={key:0},ze={key:1},Le={key:2,class:"servers-grid"},Te=["onClick"],Pe={class:"server-card-header"},Ve={class:"server-card-info"},$e={class:"server-card-name"},He={class:"server-card-meta"},Ne={class:"meta-item"},De={key:0,class:"meta-item"},Ue={class:"modal-content"},Re={class:"modal-header"},Ae={class:"modal-title"},Fe={class:"modal-body"},qe={class:"tool-detail-section"},Ge={class:"server-badge"},Oe={class:"tool-detail-section"},Qe={key:0,class:"tool-detail-section"},je={class:"schema-code"},Ee={class:"tool-detail-section"},Je={class:"stats-row"},Ie={class:"stat-item"},Ke={class:"modal-footer"},We=["disabled"],Xe={key:0,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},Ye={key:1,class:"spinning",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},Ze={class:"modal-content"},es={class:"modal-header"},ss={class:"modal-title"},ts={class:"modal-body"},os={class:"tool-detail-section"},ls={class:"server-detail-info"},as={class:"info-row"},rs={class:"info-row"},ns={class:"info-row"},is={class:"info-value"},ds={key:0,class:"info-row"},vs={class:"info-value"},us={class:"modal-footer"},cs={__name:"MCPTools",setup(ps){const _=d(!0),P=d({}),w=d([]),h=d([]),u=d(null),M=d(!1),C=d(!1),c=d(""),n=d(""),p=d(""),y=d("tools"),V=d(null),x=d(!1),G=m(()=>h.value.length),O=m(()=>w.value.length),Q=m(()=>h.value.map(l=>({id:l.id,name:l.name,tool_count:l.total_tools||0}))),$=m(()=>{let l=w.value;if(n.value&&(l=l.filter(s=>s.server_id==n.value)),c.value.trim()){const s=c.value.toLowerCase();l=l.filter(i=>i.name.toLowerCase().includes(s)||i.description&&i.description.toLowerCase().includes(s))}return l}),H=m(()=>{let l=h.value;if(p.value.trim()){const s=p.value.toLowerCase();l=l.filter(i=>i.name.toLowerCase().includes(s))}return l});function N(l){var i;const s=h.value.find(t=>t.id===l);return(s==null?void 0:s.name)||((i=P.value[l])==null?void 0:i.server_name)||`Server ${l}`}W(()=>{j()});async function j(){_.value=!0;try{const[l,s]=await Promise.all([F.getServers(),F.getToolsGrouped()]);l.success&&(h.value=l.data),s.success&&(P.value=s.data,w.value=Object.entries(s.data).flatMap(([i,t])=>t.tools.map(B=>({...B,server_id:parseInt(i)}))))}catch(l){console.error("Failed to load MCP data:",l),q.error("加载 MCP 数据失败")}finally{_.value=!1}}function E(l){u.value=l,M.value=!0}function g(){M.value=!1,setTimeout(()=>{u.value=null},200)}function J(l){V.value=l,x.value=!0}function b(){x.value=!1,setTimeout(()=>{V.value=null},200)}async function I(){q.info("Tool 调用功能开发中")}function D(l){return l?l.toLocaleString():"0"}return(l,s)=>{const i=Z("router-link");return o(),a("div",ee,[e("div",se,[e("button",{class:k(["tab-btn",{active:y.value==="tools"}]),onClick:s[0]||(s[0]=t=>y.value="tools")},[s[7]||(s[7]=e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[e("path",{d:"M14.7 6.3a1 1 0 000 1.4l1.6 1.6a1 1 0 001.4 0l1.6-1.6a1 1 0 00-1.4 0l-1.6-1.6zM12.3 8.7a1 1 0 000-1.4l-1.6-1.6a1 1 0 00-1.4 0l-1.6 1.6a1 1 0 001.4 0l1.6 1.6zM16.2 10a1 1 0 000 1.4l1.6 1.6a1 1 0 001.4 0l1.6-1.6a1 1 0 00-1.4 0l-1.6-1.6zM8.2 16.2a1 1 0 000 1.4l1.6 1.6a1 1 0 001.4 0l1.6-1.6a1 1 0 00-1.4 0l-1.6-1.6zM8 12a1 1 0 000 1.4l1.6 1.6a1 1 0 001.4 0l1.6-1.6a1 1 0 00-1.4 0L8 12zM10 16.2a1 1 0 000-1.4l-1.6-1.6a1 1 0 00-1.4 0l-1.6 1.6a1 1 0 001.4 0l1.6 1.6zM14.7 14.7a1 1 0 000-1.4l-1.6-1.6a1 1 0 00-1.4 0l-1.6 1.6a1 1 0 001.4 0l1.6 1.6z"})],-1)),s[8]||(s[8]=f(" Tools ",-1)),e("span",te,r(O.value),1)],2),e("button",{class:k(["tab-btn",{active:y.value==="servers"}]),onClick:s[1]||(s[1]=t=>y.value="servers")},[s[9]||(s[9]=e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[e("rect",{x:"4",y:"4",width:"16",height:"16",rx:"2"}),e("circle",{cx:"12",cy:"12",r:"4"}),e("path",{d:"M12 2V4M12 20V22M2 12H4M20 12H22"})],-1)),s[10]||(s[10]=f(" MCP Servers ",-1)),e("span",oe,r(G.value),1)],2)]),y.value==="tools"?(o(),a("div",le,[e("div",ae,[e("div",re,[s[12]||(s[12]=e("label",{class:"filter-label"},"按 Server 过滤:",-1)),S(e("select",{"onUpdate:modelValue":s[2]||(s[2]=t=>n.value=t),class:"filter-select"},[s[11]||(s[11]=e("option",{value:""},"全部 Servers",-1)),(o(!0),a(z,null,L(Q.value,t=>(o(),a("option",{key:t.id,value:t.id},r(t.name)+" ("+r(t.tool_count)+") ",9,ne))),128))],512),[[X,n.value]])]),e("div",ie,[s[14]||(s[14]=e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[e("circle",{cx:"11",cy:"11",r:"8"}),e("path",{d:"M21 21l-4.35-4.35"})],-1)),S(e("input",{"onUpdate:modelValue":s[3]||(s[3]=t=>c.value=t),type:"text",class:"search-input",placeholder:"搜索工具名称或描述..."},null,512),[[U,c.value]]),c.value?(o(),a("button",{key:0,onClick:s[4]||(s[4]=t=>c.value=""),class:"clear-btn"},[...s[13]||(s[13]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M18 6L6 18M6 6l12 12"})],-1)])])):v("",!0)])]),_.value?(o(),a("div",de,[...s[15]||(s[15]=[e("svg",{class:"spinner",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[e("circle",{cx:"12",cy:"12",r:"10","stroke-dasharray":"60","stroke-dashoffset":"20"})],-1),e("p",null,"加载 MCP Tools 中...",-1)])])):$.value.length===0?(o(),a("div",ve,[s[17]||(s[17]=e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[e("rect",{x:"4",y:"4",width:"16",height:"16",rx:"2"}),e("circle",{cx:"12",cy:"12",r:"4"})],-1)),e("h3",null,r(c.value||n.value?"未找到匹配的 Tools":"暂无 MCP Tools"),1),!c.value&&!n.value?(o(),a("p",ue,"请在管理中心添加并启用 MCP Server")):(o(),a("p",ce,"尝试调整搜索词或过滤条件")),!c.value&&!n.value?(o(),R(i,{key:2,to:"/admin",class:"btn-primary"},{default:T(()=>[...s[16]||(s[16]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[e("path",{d:"M12 4v16m8-8H4"})],-1),f(" 添加 MCP Server ",-1)])]),_:1})):v("",!0)])):(o(),a("div",pe,[(o(!0),a(z,null,L($.value,t=>(o(),a("div",{key:t.id,class:"tool-card",onClick:B=>E(t)},[e("div",fe,[s[18]||(s[18]=e("div",{class:"tool-icon"},[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[e("path",{d:"M14.7 6.3a1 1 0 000 1.4l1.6 1.6a1 1 0 001.4 0l1.6-1.6a1 1 0 00-1.4 0l-1.6-1.6zM12.3 8.7a1 1 0 000-1.4l-1.6-1.6a1 1 0 00-1.4 0l-1.6 1.6a1 1 0 001.4 0l1.6 1.6zM16.2 10a1 1 0 000 1.4l1.6 1.6a1 1 0 001.4 0l1.6-1.6a1 1 0 00-1.4 0l-1.6-1.6zM8.2 16.2a1 1 0 000 1.4l1.6 1.6a1 1 0 001.4 0l1.6-1.6a1 1 0 00-1.4 0l-1.6-1.6zM8 12a1 1 0 000 1.4l1.6 1.6a1 1 0 001.4 0l1.6-1.6a1 1 0 00-1.4 0L8 12zM10 16.2a1 1 0 000-1.4l-1.6-1.6a1 1 0 00-1.4 0l-1.6 1.6a1 1 0 001.4 0l1.6 1.6zM14.7 14.7a1 1 0 000-1.4l-1.6-1.6a1 1 0 00-1.4 0l-1.6 1.6a1 1 0 001.4 0l1.6 1.6z"})])],-1)),e("h4",he,r(t.name),1)]),e("p",ye,r(t.description||"暂无描述"),1),e("div",me,[s[19]||(s[19]=e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[e("rect",{x:"4",y:"4",width:"16",height:"16",rx:"2"}),e("circle",{cx:"12",cy:"12",r:"4"})],-1)),e("span",null,r(N(t.server_id)),1)]),e("div",_e,[t.call_count>0?(o(),a("span",we,[s[20]||(s[20]=e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[e("path",{d:"M13 2L3 14h9l-1 8"})],-1)),f(" "+r(D(t.call_count)),1)])):v("",!0),t.input_schema?(o(),a("span",Me," 有参数 ")):v("",!0)])],8,ke))),128))]))])):(o(),a("div",Ce,[e("div",xe,[e("div",ge,[s[22]||(s[22]=e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[e("circle",{cx:"11",cy:"11",r:"8"}),e("path",{d:"M21 21l-4.35-4.35"})],-1)),S(e("input",{"onUpdate:modelValue":s[5]||(s[5]=t=>p.value=t),type:"text",class:"search-input",placeholder:"搜索 Server 名称..."},null,512),[[U,p.value]]),p.value?(o(),a("button",{key:0,onClick:s[6]||(s[6]=t=>p.value=""),class:"clear-btn"},[...s[21]||(s[21]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M18 6L6 18M6 6l12 12"})],-1)])])):v("",!0)])]),_.value?(o(),a("div",be,[...s[23]||(s[23]=[e("svg",{class:"spinner",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[e("circle",{cx:"12",cy:"12",r:"10","stroke-dasharray":"60","stroke-dashoffset":"20"})],-1),e("p",null,"加载 MCP Servers 中...",-1)])])):H.value.length===0?(o(),a("div",Be,[s[25]||(s[25]=e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[e("rect",{x:"4",y:"4",width:"16",height:"16",rx:"2"}),e("circle",{cx:"12",cy:"12",r:"4"})],-1)),e("h3",null,r(p.value?"未找到匹配的 Servers":"暂无 MCP Servers"),1),p.value?(o(),a("p",ze,"尝试调整搜索词")):(o(),a("p",Se,"请在管理中心添加并启用 MCP Server")),p.value?v("",!0):(o(),R(i,{key:2,to:"/admin",class:"btn-primary"},{default:T(()=>[...s[24]||(s[24]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[e("path",{d:"M12 4v16m8-8H4"})],-1),f(" 添加 MCP Server ",-1)])]),_:1}))])):(o(),a("div",Le,[(o(!0),a(z,null,L(H.value,t=>(o(),a("div",{key:t.id,class:"server-card",onClick:B=>J(t)},[e("div",Pe,[e("div",{class:k(["server-icon",`server-icon--${t.transport_type}`])},[...s[26]||(s[26]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[e("rect",{x:"4",y:"4",width:"16",height:"16",rx:"2"}),e("circle",{cx:"12",cy:"12",r:"4"}),e("path",{d:"M12 2V4M12 20V22M2 12H4M20 12H22"})],-1)])],2),e("div",Ve,[e("h4",$e,r(t.name),1),e("span",{class:k(["server-card-type",`type--${t.transport_type}`])},r(t.transport_type.toUpperCase()),3)]),e("div",{class:k(["server-card-status",t.enabled?"status--enabled":"status--disabled"])},r(t.enabled?"已启用":"已禁用"),3)]),e("div",He,[e("div",Ne,[s[27]||(s[27]=e("svg",{viewBox:"0 0 16 16",fill:"currentColor"},[e("path",{d:"M14.7 6.3a1 1 0 000 1.4l1.6 1.6a1 1 0 001.4 0l1.6-1.6a1 1 0 00-1.4 0l-1.6-1.6zM12.3 8.7a1 1 0 000-1.4l-1.6-1.6a1 1 0 00-1.4 0l-1.6 1.6a1 1 0 001.4 0l1.6 1.6z"})],-1)),e("span",null,r(t.total_tools||0)+" Tools",1)]),t.total_resources>0?(o(),a("div",De,[s[28]||(s[28]=e("svg",{viewBox:"0 0 16 16",fill:"currentColor"},[e("path",{d:"M8 0a8 8 0 100 16A8 8 0 008 0zm0 14.5a6.5 6.5 0 110-13 6.5 6.5 0 010 13z"}),e("path",{d:"M8 4a4 4 0 100 8 4 4 0 000-8z"})],-1)),e("span",null,r(t.total_resources)+" Resources",1)])):v("",!0)])],8,Te))),128))]))])),u.value?(o(),a("div",{key:2,class:k(["tool-modal",{show:M.value}]),onClick:A(g,["self"])},[e("div",Ue,[e("div",Re,[e("div",Ae,[s[29]||(s[29]=e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[e("path",{d:"M14.7 6.3a1 1 0 000 1.4l1.6 1.6a1 1 0 001.4 0l1.6-1.6a1 1 0 00-1.4 0l-1.6-1.6zM12.3 8.7a1 1 0 000-1.4l-1.6-1.6a1 1 0 00-1.4 0l-1.6 1.6a1 1 0 001.4 0l1.6 1.6zM16.2 10a1 1 0 000 1.4l1.6 1.6a1 1 0 001.4 0l1.6-1.6a1 1 0 00-1.4 0l-1.6-1.6zM8.2 16.2a1 1 0 000 1.4l1.6 1.6a1 1 0 001.4 0l1.6-1.6a1 1 0 00-1.4 0l-1.6-1.6zM8 12a1 1 0 000 1.4l1.6 1.6a1 1 0 001.4 0l1.6-1.6a1 1 0 00-1.4 0L8 12zM10 16.2a1 1 0 000-1.4l-1.6-1.6a1 1 0 00-1.4 0l-1.6 1.6a1 1 0 001.4 0l1.6 1.6zM14.7 14.7a1 1 0 000-1.4l-1.6-1.6a1 1 0 00-1.4 0l-1.6 1.6a1 1 0 001.4 0l1.6 1.6z"})],-1)),e("h3",null,r(u.value.name),1)]),e("button",{class:"modal-close",onClick:g},[...s[30]||(s[30]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[e("path",{d:"M18 6L6 18M6 6L18 18"})],-1)])])]),e("div",Fe,[e("div",qe,[s[32]||(s[32]=e("h4",null,"所属 Server",-1)),e("div",Ge,[s[31]||(s[31]=e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[e("rect",{x:"4",y:"4",width:"16",height:"16",rx:"2"}),e("circle",{cx:"12",cy:"12",r:"4"})],-1)),f(" "+r(N(u.value.server_id)),1)])]),e("div",Oe,[s[33]||(s[33]=e("h4",null,"描述",-1)),e("p",null,r(u.value.description||"暂无描述"),1)]),u.value.input_schema?(o(),a("div",Qe,[s[34]||(s[34]=e("h4",null,"参数",-1)),e("pre",je,r(JSON.stringify(u.value.input_schema,null,2)),1)])):v("",!0),e("div",Ee,[s[36]||(s[36]=e("h4",null,"统计信息",-1)),e("div",Je,[e("span",Ie,[s[35]||(s[35]=f("调用次数: ",-1)),e("strong",null,r(D(u.value.call_count)),1)])])])]),e("div",Ke,[e("button",{class:"btn-secondary",onClick:g},"关闭"),e("button",{class:"btn-primary",onClick:I,disabled:C.value},[C.value?(o(),a("svg",Ye,[...s[38]||(s[38]=[e("circle",{cx:"12",cy:"12",r:"10","stroke-dasharray":"60","stroke-dashoffset":"20"},null,-1)])])):(o(),a("svg",Xe,[...s[37]||(s[37]=[e("path",{d:"M13 2L3 14h9l-1 8"},null,-1)])])),f(" "+r(C.value?"调用中...":"测试调用"),1)],8,We)])])],2)):v("",!0),n.value?(o(),a("div",{key:3,class:k(["tool-modal",{show:x.value}]),onClick:A(b,["self"])},[e("div",Ze,[e("div",es,[e("div",ss,[s[39]||(s[39]=e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[e("rect",{x:"4",y:"4",width:"16",height:"16",rx:"2"}),e("circle",{cx:"12",cy:"12",r:"4"}),e("path",{d:"M12 2V4M12 20V22M2 12H4M20 12H22"})],-1)),e("h3",null,r(n.value.name),1)]),e("button",{class:"modal-close",onClick:b},[...s[40]||(s[40]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[e("path",{d:"M18 6L6 18M6 6L18 18"})],-1)])])]),e("div",ts,[e("div",os,[s[45]||(s[45]=e("h4",null,"Server 信息",-1)),e("div",ls,[e("div",as,[s[41]||(s[41]=e("span",{class:"info-label"},"传输类型:",-1)),e("span",{class:k(["info-value type-badge",`type--${n.value.transport_type}`])},r(n.value.transport_type.toUpperCase()),3)]),e("div",rs,[s[42]||(s[42]=e("span",{class:"info-label"},"状态:",-1)),e("span",{class:k(["info-value",n.value.enabled?"status-enabled":"status-disabled"])},r(n.value.enabled?"已启用":"已禁用"),3)]),e("div",ns,[s[43]||(s[43]=e("span",{class:"info-label"},"Tools 数量:",-1)),e("span",is,r(n.value.total_tools||0),1)]),n.value.total_resources>0?(o(),a("div",ds,[s[44]||(s[44]=e("span",{class:"info-label"},"Resources 数量:",-1)),e("span",vs,r(n.value.total_resources),1)])):v("",!0)])])]),e("div",us,[e("button",{class:"btn-secondary",onClick:b},"关闭"),Y(i,{to:"/admin",class:"btn-primary"},{default:T(()=>[...s[46]||(s[46]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[e("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),e("path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})],-1),f(" 管理 Server ",-1)])]),_:1})])])],2)):v("",!0)])}}},ys=K(cs,[["__scopeId","data-v-a1d8a635"]]);export{ys as default};
